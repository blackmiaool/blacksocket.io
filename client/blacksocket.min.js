!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.io=t():e.io=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(module,exports,__webpack_require__){"use strict";function io(){function e(t){if(u.closed)return void(a&&clearInterval(a));u.ws&&u.ws.close(),o=new WS(t),o.addEventListener("close",function(){a&&clearInterval(a),u.closed||(a=setInterval(function(){e(t)},i))}),o.addEventListener("open",function(){a&&(clearInterval(a),a=null)}),u.init(o)}var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.reconnectionDelayMax,i=void 0===r?5e3:r,o=void 0,a=void 0,s=isBrowser?location.protocol.replace("http","ws"):"ws:",c=isBrowser?location.hostname:"localhost";if(t.startsWith("ws://"));else{if(!t.startsWith(":")&&!t.startsWith("/"))throw new Error("invalid addr "+t);t=s+"//"+c+t}var u=new socket_1.default;return e(t),setInterval(function(){o.readyState==WS.OPEN&&o.send(Math.floor(1e3*Math.random())+"")},25e3),u}Object.defineProperty(exports,"__esModule",{value:!0});var socket_1=__webpack_require__(1),isBrowser="undefined"!=typeof location,WS=void 0;WS=isBrowser?WebSocket:eval("require('ws')"),module.exports=io},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){if(!e)return!1;var t=Object.getPrototypeOf(e).constructor.name;return"ArrayBuffer"===t||"Buffer"===t}function a(e){return e&&"object"===(void 0===e?"undefined":f(e))}function s(e){function t(e,r){for(var i in e)o(e[i])?(r.push(i),n[0].push(r.slice()),n[1].push(e[i]),r.pop()):a(e)&&(r.push(i),t(e[i],r),r.pop())}var n=[[],[]];return t(e,[]),n[0].length?n:null}function c(e,t,n){return t.includes("constructor")||t.includes("__proto__")?[{message:"cant use meta properties(constructor, __proto__)"}]:(t.reduce(function(e,r,i){return i===t.length-1?void(e[r]=n):e[r]},e),e)}var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(t,"__esModule",{value:!0});var l=n(2),d=function(){function e(){i(this,e),Object.assign(this,{uid:1,eventListenerMap:{},cbMap:{},firstConnect:!0,closed:!1})}return u(e,[{key:"sendCb",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.underlyingEmit({type:"cb",uid:e,data:n})}},{key:"_send",value:function(e){1===this.ws.readyState&&this.ws.send(e)}},{key:"underlyingEmit",value:function(e){var t=this,n=e.event,r=e.promise,i=void 0!==r&&r,o=e.cb,a=e.data,c=e.type,u=void 0===c?"msg":c,f=e.uid,l=void 0;if(this.binaryData.length){var d=Object.assign({},arguments[0]);return i&&(l=new Promise(function(e){d.cb=e,d.promise=!1})),this.binaryMsgQueue.push(d),l}f||(f=this.uid,this.uid++);var p={type:u,uid:f,data:a,event:n,needCb:!1};(o||i)&&(p.needCb=!0,i?l=new Promise(function(e){t.cbMap[p.uid]=function(t){e(t)}}):this.cbMap[p.uid]=o);var v=s(a);return v&&(p.bufferPaths=v[0],this.binaryData=v[1]),this._send(JSON.stringify(p)),l}},{key:"init",value:function(e){var t=this;this.ws=e,this.binaryData=[],this.binaryMsgQueue=[],this.ws.on("error",function(e){console.log("blacksocket on error:",e.message)}),e.addEventListener("message",function(e){var n,i=void 0,a=void 0;if(o(e.data)){if(!t.binaryInfo)return;i=e.data,a=t.binaryInfo}else if(!e.data||"{"!==e.data[0])return;a||(a=JSON.parse(e.data));var s=a,u=s.uid,f=s.needCb,l=s.data,d=s.event,p=s.type,v=s.bufferPaths;if(i){var h=v.pop();l=c(l,h,i)}var y=function(){return!(!v||!v.length)&&(t.binaryInfo=a,t.ws.send(JSON.stringify({type:"wait-binary"})),!0)};switch(p){case"msg":if(y())return;if(!t.eventListenerMap[d])return;var m=void 0;f&&(m=function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];m&&(m=null,t.sendCb.apply(t,[u].concat(n)))}),t.eventListenerMap[d].forEach(function(e){var t=void 0;(t=e.apply(void 0,r(l).concat([m])))&&t.then&&m&&t.then(m)});break;case"wait-binary":t.ws.send(t.binaryData.pop()),!t.binaryData.length&&t.binaryMsgQueue.length&&t.underlyingEmit(t.binaryMsgQueue.shift());break;case"cb":if(y())return;t.cbMap[u]&&(n=t.cbMap)[u].apply(n,r(l)),delete t.cbMap[u]}}),e.addEventListener("open",function(){var e=t.eventListenerMap.connect,n=t.eventListenerMap.reconnect,r=t.eventListenerMap["first-connect"];e&&e.forEach(function(e){e()}),t.firstConnect?(t.firstConnect=!1,r&&r.forEach(function(e){e()})):n&&n.forEach(function(e){e()}),t.connecting=!0}),e.addEventListener("close",function(){var e=t.eventListenerMap.disconnect;e&&e.forEach(function(e){e()}),t.connecting=!1})}},{key:"close",value:function(){var e=this;this.closed=!0,1===this.ws.readyState?this.ws.close():l.setTimeout(function(){e.ws.close()},void 0)}},{key:"emitp",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this.underlyingEmit({event:e,promise:!0,data:n})}},{key:"emit",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=void 0;return"function"==typeof n[n.length-1]&&(i=n.pop()),this.underlyingEmit({event:e,data:n,cb:i}),this}},{key:"once",value:function(e,t){var n=this,r=function r(){t(),n.off(e,r)};return this.on(e,r)}},{key:"off",value:function(e,t){if(!this.eventListenerMap[e])return!1;var n=this.eventListenerMap[e].indexOf(t);return-1!==n&&(this.eventListenerMap[e].splice(n,1),!0)}},{key:"on",value:function(e,t){return this.eventListenerMap[e]||(this.eventListenerMap[e]=[]),this.eventListenerMap[e].push(t),this}}]),e}();t.default=d},function(e,t,n){function r(e,t){this._id=e,this._clearFn=t}var i=Function.prototype.apply;t.setTimeout=function(){return new r(i.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new r(i.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(3),t.setImmediate=setImmediate,t.clearImmediate=clearImmediate},function(e,t,n){(function(e,t){!function(e,n){"use strict";function r(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var r={callback:e,args:t};return u[c]=r,s(c),c++}function i(e){delete u[e]}function o(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(n,r)}}function a(e){if(f)setTimeout(a,0,e);else{var t=u[e];if(t){f=!0;try{o(t)}finally{i(e),f=!1}}}}if(!e.setImmediate){var s,c=1,u={},f=!1,l=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?function(){s=function(e){t.nextTick(function(){a(e)})}}():function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?function(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&a(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),s=function(n){e.postMessage(t+n,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){a(e.data)},s=function(t){e.port2.postMessage(t)}}():l&&"onreadystatechange"in l.createElement("script")?function(){var e=l.documentElement;s=function(t){var n=l.createElement("script");n.onreadystatechange=function(){a(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}():function(){s=function(e){setTimeout(a,0,e)}}(),d.setImmediate=r,d.clearImmediate=i}}("undefined"==typeof self?void 0===e?this:e:self)}).call(t,n(4),n(!function(){var e=new Error('Cannot find module "./../process/browser.js"');throw e.code="MODULE_NOT_FOUND",e}()))},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n}])});