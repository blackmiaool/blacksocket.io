!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(module,exports,__webpack_require__){"use strict";function io(){function e(t){if(s.closed)return void(r&&clearInterval(r));s.ws&&s.ws.close(),n=new WS(t),n.addEventListener("close",function(n){r&&clearInterval(r),r=setInterval(function(){e(t)},5e3)}),n.addEventListener("open",function(e){r&&(clearInterval(r),r=0)}),s.init(n)}var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",n=void 0,r=void 0,o=isBrowser?location.protocol.replace("http","ws"):"ws:",i=isBrowser?location.hostname:"localhost";if(!t.startsWith(":")&&!t.startsWith("/"))throw new Error("invalid addr"+t);t=o+"//"+i+t;var s=new Socket;return e(t),setInterval(function(){n.readyState==WS.OPEN&&n.send(Math.floor(1e3*Math.random())+"")},25e3),s}var Socket=__webpack_require__(1),isBrowser="undefined"!=typeof location,WS=void 0;WS=isBrowser?WebSocket:eval("require('ws')"),module.exports=io},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){r(this,e),Object.assign(this,{uid:1,eventListenerMap:{},cbMap:{},firstConnect:!0,closed:!1})}return o(e,[{key:"init",value:function(e){var t=this;this.ws=e,e.addEventListener("message",function(e){if(e.data&&"{"===e.data[0]){var n=JSON.parse(e.data),r=n.uid,o=n.needCb,i=n.data,s=n.event,a=n.type;if("msg"===a){if(!t.eventListenerMap[s])return;var c=void 0;o&&(c=function(e){t.sendCb(r,e)}),t.eventListenerMap[s].forEach(function(e){e(i,c)})}else"cb"===a&&(t.cbMap[r]&&t.cbMap[r](i),delete t.cbMap[r])}}),e.addEventListener("open",function(){var e=t.eventListenerMap.connect,n=t.eventListenerMap.reconnect,r=t.eventListenerMap["first-connect"];e&&e.forEach(function(e){e()}),t.firstConnect?(t.firstConnect=!1,r&&r.forEach(function(e){e()})):n&&n.forEach(function(e){e()})}),e.addEventListener("close",function(){var e=t.eventListenerMap.disconnect;e&&e.forEach(function(e){e()})})}}]),o(e,[{key:"open",value:function(){this.closed=!1,this.ws.open()}},{key:"close",value:function(){this.closed=!0,this.ws.close()}},{key:"emit",value:function(e,t,n){var r={};r.uid=this.uid,this.uid++,n&&(r.needCb=!0,this.cbMap[r.uid]=n),r.data=t,r.event=e,r.type="msg",1===this.ws.readyState&&this.ws.send(JSON.stringify(r))}},{key:"sendCb",value:function(e,t){this.ws.send(JSON.stringify({type:"cb",uid:e,data:t}),function(e){e&&console.warn("err",e)})}},{key:"on",value:function(e,t){this.eventListenerMap[e]||(this.eventListenerMap[e]=[]),this.eventListenerMap[e].push(t)}}]),e}();e.exports=i}])});